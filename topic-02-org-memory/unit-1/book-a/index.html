<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css"
          type="text/css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/railscasts.min.css"
          rel="stylesheet"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style>
      

body {
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
  font-size:90%;
  color: black;
}

p {
  margin: 0.5em;
}

pre code {
  font-family: "Monaco";
  font-size: 100%;
}

img {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  margin:10px;
}

h1, h2, h3 {
  border-bottom:thin solid black;
  margin-bottom: 0.5em;
  margin-top: 1em;
}

h1 {
  font-style:italic;
  font-size:130%;
}

h2 {
  font-size:110%;
}

h3 {
  font-size:100%;
}



      

html, body {
  height: 100%;
  margin: 0;
}
.wrapper {
  height: 100%;
  display: flex;
  flex-direction: column;
}
.footer {
  background: white;
  text-align: right;
}
.content {
  flex: 1;
  overflow: auto;
}



    </style>
  </head>

  
  

  <div class="ui fixed top pointing inverted stackable menu labmenu">
    <header class="header item">
      <i id="toc" class="sitemap icon"></i>
      
        <a href="../../index.html"> Organisation Memory I  </a>
      
    </header>
    <div class="right tab-menu menu">
      
        <a class="item" data-tab="Lab-02">
          Lab-02
        </a>
      
        <a class="item" data-tab="01">
          01
        </a>
      
        <a class="item" data-tab="02">
          02
        </a>
      
        <a class="item" data-tab="03">
          03
        </a>
      
        <a class="item" data-tab="04">
          04
        </a>
      
        <a class="item" data-tab="05">
          05
        </a>
      
    </div>
  </div>


  

  <div class="ui pushable">
    <div class="ui inverted labeled icon left inline vertical sidebar menu">
      <br><br>
      
        
          
            <a class="item"
               href="https://ruthbwit.github.io/bi-msc//topic-01-intro/unit-1/book-a/index.html">Assignment </a>
          
        
      
        
          
            <a class="item"
               href="https://ruthbwit.github.io/bi-msc//topic-01-intro/unit-2/book-a/index.html">Lab-01 </a>
          
        
      
        
          
            <a class="item"
               href="https://ruthbwit.github.io/bi-msc//topic-02-org-memory/unit-1/book-a/index.html">Lab-02 </a>
          
        
      
        
          
            <a class="item"
               href="https://ruthbwit.github.io/bi-msc//topic-02-org-memory/unit-2/book/index.html">Lab-03 </a>
          
        
      
    </div>
    <div class="pusher" tabindex="-1">
      <div class="ui basic segment">
        <br>
        
          <div class="ui tab segment lab" data-tab="Lab-02">
            <h1>Multi-dimensional Reporting</h1>
<p>This lab will continue with Excel’s Pivot table feature for the purpose of doing Online Analytical Processing (OLAP). </p>
<p>It is an easy way to increase insights into data through aggregation.  OLAP enables users to analyse different dimensions of multidimensional data.  In a multidimensional approach, data is organized into dimensions. A number of multi-dimensional navigational techniques will be introduced, e.g. drill-down, slice and dice. Terminology explained:</p>
<h2>Dimension</h2>
<p>A dimension is a context, aspect or perspective by which the facts may be described, accessed, grouped, selected, sequenced, filtered and presented. A dimension reflects how business users typically think of the business. For example business users may view their data by product, customers, time etc...</p>
<h2>Fact</h2>
<p>A fact is measurement/metric, mostly always numeric. Example: revenue, quantity, price etc…</p>
<h2>Multi-dimensional</h2>
<p>Multidimensional means a fact always relates to one or more dimensions.</p>
<h2>OLAP techniques:</h2>
<ul>
<li><p>Slice: selects one dimension e.g. year – select ‘2018’</p>
</li>
<li><p>Dice: is selecting two or more dimensions, e.g. year – select ‘2018’, product – ‘shoe’, locations – ‘Dublin’</p>
</li>
<li><p>Roll up: is based upon levels organised in hierarchies.  E.g. the application may roll up sales by week, month, quarter and year</p>
</li>
<li><p>Drill-down: is the reverse of roll-up, drilling down the hierarchy, e.g. year to month</p>
</li>
</ul>

          </div>
        
          <div class="ui tab segment lab" data-tab="01">
            <h1>Using Microsoft Excel for Multidimensional Analysis</h1>
<p>Business case: Robert Jones is a manager of several sales organizations at Global Bike Inc. and his responsibilities are monitoring and managing sales activities. He has a number of OLTP systems to assist with the recording of day-to-day transactions. At the end of each month, he is provided with a report which displays each sale. The format of the report is illustrated below. Although this report provides a lot of information, the information is not in a format that can easily assist in the type of decisions you are required to make. Robert has decided to examine the PivotTables as means of producing more useful reports.</p>
<p>The sales data is delivered by the IT Department in the following format:</p>
<p><img src="./img/01.png" alt=""></p>
<h2>Task</h2>
<p>The purpose of this exercise is to create a PivotTable in Microsoft Excel in order to analyse the data using the multi-dimensional reporting.  A number of multi-dimensional navigational techniques will be introduced. Moreover, some special techniques for presenting FACTS which are known as key figures will be shown:</p>
<ul>
<li>Download the zip file and open the SalesdataPivotV01 file <a href="./archives/sales-power.zip">sales-power.zip</a>.</li>
<li>Insert a Pivot table.</li>
<li>Start with a high level overview and create a pivot table, which shows the revenue in Germany and the US throughout the years.</li>
</ul>
<p><img src="./img/02.png" alt=""></p>
<ul>
<li><p>Drag and Drop the fields YEAR, Country and Revenue in USD from the field list (1) to the report areas (2) and watch the result (3).
<img src="./img/03.png" alt=""></p>
</li>
<li><p>Use the context menu on a data cell to adjust Value Field Settings.
<img src="./img/04.png" alt=""></p>
</li>
<li><p>Choose Number Format (1) Currency (2) $ English (U.S.) with 0 Decimal Places (3).
<img src="./img/05.png" alt=""></p>
</li>
<li><p>You might want to save the intermediate result.</p>
</li>
</ul>
<h2>Rotate</h2>
<p>Rotate the view by swapping the axes.
<img src="./img/06.png" alt="">
-    You can observe a different behavior of two countries: whereas Germany shows a continuous increase in revenue, there is a sharp decline in the US in 2009. </p>
<h3>Solution</h3>
<p><img src="./img/07.png" alt=""></p>
<ul>
<li>Try now to identify reasons for this behaviour in the data! Do this by slicing the data (see the next step).</li>
</ul>
<h2>Slice</h2>
<p>We analyse the data from Germany first and, therefore, do a slice on country. Switch the Key figure to Revenue in local currency.
<img src="./img/08.png" alt=""></p>
<h2>Drill down to Sales Organization and Customer</h2>
<p>Next, drill down to the sales organization. There is no dependency visible: both sales organizations behave similarly.
<img src="./img/09.png" alt=""></p>
<h3>Solution</h3>
<p><img src="./img/10.png" alt=""></p>
<p>From sales organization, drill down to customer. Everything looks fine!
<img src="./img/11.png" alt=""></p>
<h3>Solution</h3>
<p><img src="./img/12.png" alt="">
- Make sure the Classic PivotTable layout is NOT selected (2).</p>
<p><img src="./img/13.png" alt=""></p>
<h2>Rotation</h2>
<p>Check the dependency on the product category and product by rotating the cube.
<img src="./img/14.png" alt=""></p>
<p>We observe the introduction of a new product in 2010: the new E-bike Tailwind. Now analyse the new market in more detail.</p>
<h3>Solution</h3>
<p>Adjust Row Labels (1). Expand and Collapse as needed (2).
<img src="./img/15.png" alt=""></p>
<h2>Show percentage values</h2>
<p>Compare the new E-bike with other bikes. Filter the last two years an all bikes (filter on Division!). Instead of showing the revenue in absolute numbers, show values as % of Column Total. Sort the data by revenue. We recognize that the new product already contributes more than 5% to the total revenue!</p>
<p><img src="./img/16.png" alt=""></p>
<h3>Solution</h3>
<p>Remove Product Category (1). Add appropriate filter for Division (2) and YEAR (3).</p>
<p><img src="./img/17.png" alt=""></p>
<p>Show values as % of Column Total (1) and sort (2) descending.
<img src="./img/18.png" alt=""></p>
<h2>Drill-through</h2>
<p>To finish the analysis of Germany find out, when the new E-bike was sold for the first time. For this have a look at all order items sorted by date.
<img src="./img/19.png" alt=""></p>
<h3>Solution</h3>
<p>Double-click on the E-Bike 2010 value. A new worksheet is created.
<img src="./img/20.png" alt=""></p>
<p>On the Data tab (1) call Sort (2) and use Add Level (3) to sort by MONTH and DAY.
<img src="./img/21.png" alt=""></p>

          </div>
        
          <div class="ui tab segment lab" data-tab="02">
            <h2>Pivot Tables - Analyzing the US Data</h2>
<p>In the following, we analyse the situation in the US. Remember that we observed a sharp revenue decline between 2008 and 2009 and we want to find out reasons for this. Therefore change country to US (1) and remove all other filters. Since revenue is in local currency, change the format to $. In order to obtain Customer and City in two separate columns (2) you have to switch to the Classic PivotTable layout (cf. PivotTable Options). We observe that a very important customer is lost between 2010 and 2011 (3).</p>
<p><img src="./img/22.png" alt=""></p>
<h3>Solution</h3>
<p>To switch to the Classic PivotTable layout call PivotTable Options...</p>
<p><img src="./img/23.png" alt="">
and use the Display tab (1) to select the required option (2).</p>
<p>All other adjustments can be done as before. By default subtotals are shown, which can be changed in context menu.</p>
<p><img src="./img/24.png" alt="">    </p>
<h2>Insert a Chart</h2>
<p>We want to explore this in more detail and use a chart to visualize the data. Filter Silicon Valley Bikes and Beantown Bikes Boston and the years 2009 to 2011 (dice operator). Drill down to calendar month and insert a line chart.</p>
<p><img src="./img/25.png" alt="">
All navigation steps can be done as before.</p>
<p><img src="./img/26.png" alt=""></p>
<p>A chart can be added using the Insert tab.</p>
<p><img src="./img/27.png" alt=""></p>
<h2>Conditional Formatting</h2>
<p> In order to detect other effects we remove the filter on the calendar year, exclude this customer from the subsequent steps....</p>
<p><img src="./img/28.png" alt=""></p>
<p>... and look at the monthly values compared to the previous year.</p>
<p><img src="./img/29.png" alt=""></p>
<p>This shows a decline in September 2008 (Lehman crisis) which is partially recovered in the following years.</p>
<p><img src="./img/30.png" alt=""></p>
<h3>Solution</h3>
<p>Exclude customer Silicon Valley Bikes and show all years in columns. Add MONTH to rows.
<img src="./img/31.png" alt=""></p>
<p>Change presentation of numbers by right-clicking on a data cell and selecting Show values as % Difference from
<img src="./img/32.png" alt=""></p>
<p>Choose YEAR as Base Field.
<img src="./img/33.png" alt=""></p>
<p>If necessary accept the system message.
Mark all the data cells (1) and select Conditinal Formating (2) with Green - Yellow - Red Color Scale (3).</p>
<p><img src="./img/34.png" alt=""></p>
<h2>Task - Develop your skills</h2>
<p>Flops</p>
<ul>
<li>What product sold the least number of units?</li>
</ul>
<p>Top Seller</p>
<ul>
<li>What product category provided the most revenue in 2011?  </li>
</ul>
<p>Sales by Product Category</p>
<ul>
<li>What percentage did the off-road bikes contribute to the overall bicycle sales quantity?  </li>
</ul>
<ul>
<li>In which three cities was this percentage significantly above the average?</li>
</ul>
<p>(K. Freyburger &amp; T. Hagen 2016,SAP BI Curriculum )</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="03">
            <h1>PowerPivot</h1>
<p>There are many ways to analyse and summarise data in Excel, one feature is called PowerPivot. It is similar to the PivotTable feature you covered in the previous labs. However, PowerPivot is able to run pivot tables by merging several big datasets and run pivot tables off the consolidated data.</p>
<p>To use PowerPivot you must be familiar with the Internal Data Model (IDM). IDM is the analytical engine that Excel uses behind the scenes to construct the PowerPivot. It is basically a database in which Excel organises information. Two features that are useful: first, it can establish relationships between multiple databases. Second, it can hold unlimited number of rows and columns. You are only limited by a 2 gigabyte workbook and the memory available on the machine where Excel is running. (IDM is only available in Excel 2013 or newer)</p>
<p>To activate PowerPivot we need to add it to our available tabs in Excel. Go to the File menu and choose options.</p>
<p><img src="./img/35.png" alt=""></p>
<p>Excel options box opens, choose Add-ins from the menu on the left and then choose COM Add-ins from the drop down list Label Managed:</p>
<p><img src="./img/36.png" alt="">
Click Go.
Check the box for Microsoft</p>
<p>Tick PowerPivot for Excel and click OK.
<img src="./img/37.png" alt=""></p>
<p>Now you should see the PowerPivot tab appear on the top ribbon in Excel.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="04">
            <h1>Linking Data Tables</h1>
<p>We will work on some Airline data for this step. Download the file PowerPivot.xls from the zip file. There are four data tables in this workbook each containing different kinds of airline data. </p>
<p>The first is Flights, it contains information relating to flights out of Chicago, including:</p>
<ul>
<li>destination</li>
<li>the ID of the aircraft</li>
<li>the scheduled departure time</li>
<li>pricing information </li>
<li>date of the flight</li>
</ul>
<p>The second is Routes, it provide insight into</p>
<ul>
<li>the specific departure and arrival airports</li>
<li>the distance</li>
<li>list price</li>
</ul>
<p>Note that all flights are coming out of ORD with is the airport code for O&#39;Hare International Airport Chicago.</p>
<p>The third data table is the Aircraft tab, it provides specs for all aircraft in the fleet</p>
<ul>
<li>type of aircraft</li>
<li>seat capacity</li>
<li>fuel cost per seat per mile</li>
</ul>
<p>The last data table is the Airports tab which provides</p>
<ul>
<li>airport full name</li>
<li>number of available gates</li>
</ul>
<p>This lesson will address how to analyse this data, it is no simple task as the data is spread over several tabs. For example if the business asked you to analyse the types of aircraft that frequent certain routes and have delays, it would require you to combine data from the flights, aircraft and routes tabs. Instead of going back and forth between tabs we can use the relational data model and PowerPivot to analyse data across multiple tabs.</p>
<p>First we convert the flights data into a table format so that we can use it in our PowerPivot data model. </p>
<p>Click on the flights tab, select the entire dataset, navigate to the insert menu ribbon and choose Table from the options available. You will see a dialog box open to confirm the data range and confirm that the data has a row of headers. It is considered best practice to include headers when selecting a data set. This allows Excel to add informative field names in the data model and clarity to the user.</p>
<p><img src="./img/38.png" alt=""></p>
<p>Click OK. The dataset is now formatted in a default table style. You will notice when the table is active that another tab called Table Tools Design appears on the main ribbon and the name of the table is presented to you.</p>
<p><img src="./img/39.png" alt=""></p>
<p>Now when we select any cell the design tab appears. We can change the name of the table as it is good practice to change it from the default. Let&#39;s call this set of data flights.</p>
<p><img src="./img/40.png" alt=""></p>
<p>Next we complete our data model in PowerPivot. 
- Start with the flights table, click on a cell in the table
- Navigate to the PowerPivot tab and click on the Add to Data Model button</p>
<p><img src="./img/41.png" alt=""></p>
<p>The PowerPivot table is then displayed in a separate window. 
- repeat these steps for each table until all four are added.</p>
<p><img src="./img/42.png" alt=""></p>
<p>Now that we have added all 4 of the tables to our data model, we need to form the required relationships between the tables to create our PowerPivot.
- Click on the tab called Pivot 1a. Next navigate to the PowerPivot tab, and select the Manage option. It may take a couple of seconds to load the data. 
- Click on the Diagram View option</p>
<p><img src="./img/43.png" alt=""></p>
<p>This enables us to see each of the tables we have saved within the data model. For each table we must identify the links to the other tables by dragging lines between the tables, in order to create relationships. In order for this linking to work the columns must have exactly the same name.</p>
<p><img src="./img/44.png" alt=""></p>
<p>Route ID appears in the routes table and the flights table, this means it is a foreign key in the flights table and a primary key in the routes table.
- Click on the route ID in the flights table and drag it onto the route ID in the routes table.</p>
<p><img src="./img/45.png" alt=""></p>
<p>This creates a link in the diagram showing that these fields are the same. aircraft ID also appears in two tables, create the link as before. Lastly link the two occurrences of airport ID.</p>
<p>Tip: always link from the foreign key side to the primary key side in a relationship.</p>
<p><img src="./img/46.png" alt=""></p>
<p>All tables in the diagram are now connected, no single table stands on its own. Close the PowerPivot view.</p>

          </div>
        
          <div class="ui tab segment lab" data-tab="05">
            <h1>PowerPivot to Visualise Data</h1>
<p>For this exercise you are asked to look into the specific metrics with regard to flights and the aircraft that are being used. We are going to use the data model that we created in the last step.</p>
<p>If we want to answer the question: How many flights use the A319 aircraft? We know that flight and aircraft data are stored in two different tabs of data. However we have used the aircraft ID to link those data sets together.</p>
<p>Go to a new tab, name it Exercise 2. We are going to place our pivot table in this new tab so it can expand as needed. - Select the first cell in A1. - Next navigate to the PowerPivot tab on the ribbon - Click Manage - Click Pivot Table</p>
<p><img src="./img/47.png" alt=""></p>
<p>It prompts you to confirm that you want a pivot table created in the existing worksheet</p>
<p><img src="./img/48.png" alt="">
- All four tables in our data model appear on the right hand side.
- To answer the question we must combine the aircraft and flight datasets. Expand those two datasets.</p>
<p><img src="./img/49.png" alt=""></p>
<ul>
<li>Now we can see flight ID and aircraft type. Drag these two fields into the values and rows fields respectively.</li>
<li>Now we see the pivot table form.</li>
<li>It shows a count of the flightIDs which is what we want to show since we are answering the question how many flights use the A319 aircraft.</li>
<li>Cell B2 shows us there were 3879 flights that used the A319 aircraft.</li>
<li>The second question we wish to answer is: What is the most common type of aircraft used across all flights? What is the answer?</li>
<li>The next question is: What is the maximum average ticket price for flights on the A320 aircraft?</li>
<li>You can create a new tab if you wish to answer this question or re-work your existing power pivot.</li>
<li>We need the aircraft type (rows) and ticket price (values)</li>
<li>By default the average ticket price is summed so we want to change this</li>
<li>Click the dropdown arrow for Sum of Avg Ticket Price in the Values section, choose Value Field Setting.</li>
</ul>
<p><img src="./img/50.png" alt=""></p>
<ul>
<li>Choose Max from the list of options to summarise by.</li>
</ul>
<p><img src="./img/51.png" alt=""></p>
<h2>PivotCharts</h2>
<p>Another feature of PowerPivot is PivotCharts.
This allows you to visualise data across multiple data sources. In this particular case we are being asked to visualise the number of flights flown for each aircraft type.</p>
<ul>
<li>Open a new tab name it PivotChart</li>
<li>Click in cell D12 and then click on PowerPivot, then the Manage button and then the arrow below PivotTable.</li>
<li>Choose PivotChart and use the existing workbook.</li>
</ul>
<p><img src="./img/52.png" alt=""></p>
<ul>
<li>You can adjust the height and width of the chart.</li>
<li>Next select the fields for the x and y axis.</li>
<li>Aircraft type should be placed in the Axis section.</li>
<li>FlightID should be placed in the Values section.</li>
<li>You can change the title by double clicking the text (change it to Flight ID vs Aircraft Type).</li>
<li>The filter in the bottom left corner of the chart can be used to filter to only two types of aircrafts.</li>
</ul>

          </div>
        
      </div>
    </div>
  </div>


  <br>
  <script>
    $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

    $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

  </script>



  <div class="ui bottom fixed borderless right menu">
    <div class="ui right small menu">
      <div class="ui tiny basic message segment">
         Powered by <a href="https://github.com/edeleastar/tutors-ts">tutors-ts.</a> 
      </div>
    </div>
  </div>

  </body>

</html>